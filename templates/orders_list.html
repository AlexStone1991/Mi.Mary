{% extends "base.html" %}
{% block content %}
 
<div class="container my-5">
    {% if user.is_staff %}
<div class="d-flex justify-content-between align-items-center mb-4">
<h1 class="mb-0">Список заявок</h1>
<a href="{% url 'landing' %}" class="btn btn-outline-secondary">
<i class="bi bi-house-door"></i> На главную
</a>
</div>
 
        <div class="accordion mb-4" id="searchAccordion">
<div class="accordion-item">
<h2 class="accordion-header" id="headingOne">
<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSearch" aria-expanded="false" aria-controls="collapseSearch">
<i class="bi bi-search me-2"></i> Поиск и фильтрация
</button>
</h2>
<div id="collapseSearch" class="accordion-collapse collapse {% if search_query %}show{% endif %}" aria-labelledby="headingOne" data-bs-parent="#searchAccordion">
<div class="accordion-body">
<form method="get" class="row g-3 align-items-center">
<div class="col-lg-6">
<label for="searchInput" class="visually-hidden">Поиск...</label>
<input type="text" name="q" id="searchInput" class="form-control"
                                       placeholder="Введите имя, телефон или текст комментария..." value="{{ search_query }}">
</div>
<div class="col-lg-4">
<fieldset>
<legend class="col-form-label col-auto pt-0">Искать в полях:</legend>
<div class="d-flex flex-wrap">
<div class="form-check form-check-inline">
<input class="form-check-input" type="checkbox" id="checkName" name="search_fields" value="client_name" {% if 'client_name' in search_fields or not search_fields %}checked{% endif %}>
<label class="form-check-label" for="checkName">Имя</label>
</div>
<div class="form-check form-check-inline">
<input class="form-check-input" type="checkbox" id="checkPhone" name="search_fields" value="phone" {% if 'phone' in search_fields or not search_fields %}checked{% endif %}>
<label class="form-check-label" for="checkPhone">Телефон</label>
</div>
<div class="form-check form-check-inline">
<input class="form-check-input" type="checkbox" id="checkComment" name="search_fields" value="comment" {% if 'comment' in search_fields or not search_fields %}checked{% endif %}>
<label class="form-check-label" for="checkComment">Комментарий</label>
</div>
</div>
</fieldset>
</div>
<div class="col-lg-2 text-end">
<button type="submit" class="btn btn-dark w-100">Найти</button>
</div>
</form>
</div>
</div>
</div>
</div>
 
        <div class="row">
            {% for order in orders %}
<div class="col-xl-4 col-md-6 mb-4">
                    {% include "include_order_card.html" %}
</div>
            {% empty %}
<div class="col-12">
<div class="alert alert-info text-center">
<p class="mb-0">По вашему запросу ничего не найдено, или заявок пока нет.</p>
</div>
</div>
            {% endfor %}
</div>
 
    {% else %}
<div class="row justify-content-center">
<div class="col-md-8">
<div class="alert alert-warning text-center p-5">
<h2 class="alert-heading">Доступ запрещён</h2>
<p>Только сотрудники Mi Mary могут просматривать этот раздел.</p>
<hr>
<a href="{% url 'landing' %}" class="btn btn-dark">Вернуться на главную</a>
</div>
</div>
</div>
    {% endif %}
</div>
{% endblock content %}